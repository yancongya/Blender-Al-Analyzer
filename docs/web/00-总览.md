# Web 前端总览

## 项目信息

| 属性 | 值 |
|------|-----|
| 名称 | chatgpt-web |
| 版本 | 2.11.1 |
| 作者 | ChenZhaoYu |
| 描述 | ChatGPT Web - Blender AI 节点分析器 Web 界面 |
| 许可证 | 开源 |

## 技术栈

### 核心框架

| 技术 | 版本 | 用途 |
|------|------|------|
| Vue | 3.3.4 | 前端框架 |
| TypeScript | ~4.9.5 | 类型系统 |
| Vite | 4.2.0 | 构建工具 |
| Vue Router | 4.1.6 | 路由管理 |
| Pinia | 2.0.33 | 状态管理 |
| Vue I18n | 9.2.2 | 国际化 |

### UI 框架

| 技术 | 版本 | 用途 |
|------|------|------|
| Naive UI | 2.34.3 | UI 组件库 |
| Tailwind CSS | 3.2.7 | CSS 框架 |
| Less | 4.1.3 | CSS 预处理器 |

### 功能库

| 技术 | 版本 | 用途 |
|------|------|------|
| @vueuse/core | 9.13.0 | Vue 组合式工具库 |
| highlight.js | 11.7.0 | 代码高亮 |
| markdown-it | 13.0.1 | Markdown 解析 |
| katex | 0.16.4 | 数学公式渲染 |
| @vscode/markdown-it-katex | 1.0.3 | Markdown KaTeX 插件 |
| html-to-image | 1.11.11 | HTML 转图片 |
| codemirror | 5.65.11 | 代码编辑器 |
| codemirror-editor-vue3 | 2.8.0 | CodeMirror Vue 3 集成 |
| cytoscape | 3.33.1 | 图形可视化 |
| cytoscape-dagre | 2.5.0 | Cytoscape Dagre 布局 |
| dagre | 0.8.5 | 图形布局算法 |
| @vue-flow/core | 1.48.1 | Vue Flow 核心 |
| @vue-flow/controls | 1.1.3 | Vue Flow 控件 |
| @vue-flow/background | 1.3.2 | Vue Flow 背景 |
| mermaid-it-markdown | 1.0.8 | Mermaid 图表 |
| axios | 1.3.4 | HTTP 客户端 |
| crypto-js | 4.1.1 | 加密库 |

### 开发工具

| 技术 | 版本 | 用途 |
|------|------|------|
| @vitejs/plugin-vue | 4.0.0 | Vite Vue 插件 |
| vite-plugin-pwa | 0.14.4 | PWA 支持 |
| vue-tsc | 1.2.0 | TypeScript 编译器 |
| eslint | 8.35.0 | 代码检查 |
| @antfu/eslint-config | 0.35.3 | ESLint 配置 |
| @commitlint/cli | 17.4.4 | Git 提交检查 |
| husky | 8.0.3 | Git 钩子管理 |
| lint-staged | 13.1.2 | Git 暂存文件检查 |
| postcss | 8.4.21 | CSS 转换 |
| autoprefixer | 10.4.13 | CSS 自动前缀 |
| npm-run-all | 4.1.5 | 并行运行 npm 脚本 |

## 项目结构

```
chatgpt-web/
├── .devcontainer/           # 开发容器配置
├── .github/                 # GitHub 配置
│   └── workflows/           # GitHub Actions
├── .husky/                  # Git 钩子
├── .vscode/                 # VS Code 配置
├── dist/                    # 构建输出
├── docs/                    # 文档
├── node_modules/            # 依赖包
├── public/                  # 静态资源
│   ├── avatar.png           # 默认头像
│   └── favicon.svg          # 网站图标
├── service/                 # 服务层
│   ├── .env.example         # 环境变量示例
│   ├── package.json         # 服务层包配置
│   ├── tsconfig.json        # TypeScript 配置
│   └── src/                 # 服务层源码
├── src/                     # 源代码
│   ├── api/                 # API 接口
│   ├── assets/              # 资源文件
│   ├── components/          # 组件
│   ├── hooks/               # 自定义 Hooks
│   ├── icons/               # 图标
│   ├── locales/             # 国际化
│   ├── plugins/             # 插件
│   ├── router/              # 路由
│   ├── store/               # 状态管理
│   ├── styles/              # 样式
│   ├── typings/             # 类型定义
│   ├── utils/               # 工具函数
│   ├── views/               # 页面
│   ├── App.vue              # 根组件
│   └── main.ts              # 入口文件
├── .commitlintrc.json       # Commitlint 配置
├── .dockerignore            # Docker 忽略文件
├── .editorconfig            # 编辑器配置
├── .eslintignore            # ESLint 忽略文件
├── .eslintrc.cjs            # ESLint 配置
├── .gitattributes           # Git 属性
├── .gitignore               # Git 忽略文件
├── .npmrc                   # npm 配置
├── CHANGELOG.md             # 更新日志
├── CONTRIBUTING.en.md       # 贡献指南（英文）
├── CONTRIBUTING.md          # 贡献指南
├── Dockerfile               # Docker 配置
├── index.html               # HTML 入口
├── license                  # 许可证
├── package.json             # 包配置
├── package-lock.json        # 包锁定文件
├── pnpm-lock.yaml           # pnpm 锁定文件
├── postcss.config.js        # PostCSS 配置
├── README.md                # 项目说明
├── README.zh.md             # 项目说明（中文）
├── start.cmd                # Windows 启动脚本
├── start.sh                 # Linux/Mac 启动脚本
├── tailwind.config.js       # Tailwind CSS 配置
├── tsconfig.json            # TypeScript 配置
└── vite.config.ts           # Vite 配置
```

## 核心功能

### 1. 聊天界面

- 多轮对话支持
- 流式响应
- Markdown 渲染
- 代码高亮
- 数学公式渲染
- 图表渲染
- 导出对话为图片

### 2. Blender 节点集成

- 节点数据同步
- 节点数据可视化
- 变量插入
- 注记节点创建
- 节点数据刷新

### 3. AI 配置

- 多 AI 服务商支持（DeepSeek、Ollama、BigModel）
- 模型切换
- 系统提示词管理
- 输出详细程度控制
- 温度、Top P 参数调整

### 4. 高级功能

- 深度思考模式
- 联网搜索
- 对话记忆
- 提示词模板
- 国际化支持
- 主题切换
- 响应式设计

## 页面路由

| 路径 | 名称 | 组件 | 描述 |
|------|------|------|------|
| `/` | Root | ChatLayout | 根路径，重定向到 /chat |
| `/chat/:uuid?` | Chat | Chat | 聊天页面 |
| `/404` | 404 | 404 | 404 页面 |
| `/500` | 500 | 500 | 500 页面 |
| `/:pathMatch(.*)*` | notFound | 404 | 未找到页面 |

## 状态管理

### Store 模块

| 模块 | 描述 |
|------|------|
| app | 应用全局状态 |
| auth | 认证状态 |
| chat | 聊天状态 |
| prompt | 提示词状态 |
| settings | 设置状态 |
| user | 用户状态 |

## API 接口

| 接口 | 方法 | 描述 |
|------|------|------|
| `/chat` | POST | 聊天接口 |
| `/config` | POST | 获取配置 |
| `/blender-data` | GET | 获取 Blender 数据 |
| `/stream-analyze` | POST | 流式分析 |
| `/session` | POST | 会话管理 |
| `/verify` | POST | 验证令牌 |
| `/ui-config` | GET | 获取 UI 配置 |
| `/trigger-refresh` | POST | 触发刷新 |
| `/save-ui-config` | POST | 保存 UI 配置 |
| `/prompt-templates` | GET | 获取提示词模板 |
| `/save-prompt-templates` | POST | 保存提示词模板 |
| `/import-prompt-templates` | POST | 导入提示词模板 |
| `/default-prompt-templates` | GET | 获取默认提示词模板 |
| `/create-annotation` | POST | 创建注记 |
| `/update-annotation` | POST | 更新注记 |
| `/open-annotation-editor` | POST | 打开注记编辑器 |
| `/fit-annotation` | POST | 调整注记宽度 |
| `/provider-list-models` | POST | 获取服务商模型列表 |

## 组件结构

### 通用组件 (src/components/common)

| 组件 | 描述 |
|------|------|
| HoverButton | 悬浮按钮 |
| NaiveProvider | Naive UI 提供者 |
| PromptStore | 提示词存储 |
| SelectionSend | 选择发送 |
| Setting | 设置 |
| SvgIcon | SVG 图标 |
| UserAvatar | 用户头像 |

### 自定义组件 (src/components/custom)

| 组件 | 描述 |
|------|------|
| GithubSite | GitHub 站点 |

### 聊天组件 (src/views/chat/components)

| 组件 | 描述 |
|------|------|
| Header | 头部 |
| Message | 消息 |
| BlenderNode | Blender 节点 |
| NodeDataView | 节点数据视图 |
| VariableRichInput | 变量富输入 |

### 布局组件 (src/views/chat/layout)

| 组件 | 描述 |
|------|------|
| Layout | 布局 |
| Permission | 权限 |
| sider | 侧边栏 |

## Hooks

| Hook | 描述 |
|------|------|
| useBasicLayout | 基础布局 |
| useIconRender | 图标渲染 |
| useLanguage | 语言 |
| useTheme | 主题 |
| useScroll | 滚动 |
| useChat | 聊天 |
| useUsingContext | 上下文使用 |

## 国际化支持

| 语言 | 文件 |
|------|------|
| 英语 | en-US.ts |
| 西班牙语 | es-ES.ts |
| 韩语 | ko-KR |
| 俄语 | ru-RU.ts |
| 越南语 | vi-VN.ts |
| 中文（简体） | zh-CN.ts |
| 中文（繁体） | zh-TW.ts |

## 主题支持

| 主题 | 描述 |
|------|------|
| 亮色主题 | 浅色模式 |
| 暗色主题 | 深色模式 |

## 构建脚本

| 脚本 | 描述 |
|------|------|
| `dev` | 启动开发服务器 |
| `build` | 构建生产版本 |
| `preview` | 预览生产版本 |
| `build-only` | 仅构建 |
| `type-check` | 类型检查 |
| `lint` | 代码检查 |
| `lint:fix` | 修复代码问题 |
| `bootstrap` | 初始化项目 |
| `common:cleanup` | 清理依赖 |
| `common:prepare` | 准备项目 |

## 配置文件

| 文件 | 描述 |
|------|------|
| `vite.config.ts` | Vite 配置 |
| `tsconfig.json` | TypeScript 配置 |
| `tailwind.config.js` | Tailwind CSS 配置 |
| `postcss.config.js` | PostCSS 配置 |
| `.eslintrc.cjs` | ESLint 配置 |
| `.commitlintrc.json` | Commitlint 配置 |
| `.editorconfig` | 编辑器配置 |

## 特殊功能

### 1. Cherry Studio 风格布局

- 水平布局
- 绿色主题
- 功能图标分组

### 2. 输出详细程度

- 简约模式：无格式
- 适中模式：Markdown 格式
- 详细模式：图表、列表、代码块

### 3. 节点数据过滤

- 极简：仅最小标识
- 简化：保留必要的 IO
- 常规：清除可视属性
- 完整：完整上下文

### 4. 变量插入

- 支持 `{{Current Node Data}}` 变量
- 拖拽插入
- 自动替换

## 文档索引

- [01-主界面文档](./01-主界面文档.md)
- [02-组件文档](./02-组件文档.md)
- [03-Store 文档](./03-Store文档.md)
- [04-API 文档](./04-API文档.md)
- [05-Hooks 文档](./05-Hooks文档.md)
- [06-路由文档](./06-路由文档.md)
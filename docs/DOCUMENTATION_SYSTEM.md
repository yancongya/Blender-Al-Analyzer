# 文档阅读系统使用说明

## 功能概述

文档阅读系统是一个基于 Blender 后端的简易文档查看工具，可以读取和查看 `docs` 文件夹下的 Markdown 文档。

## 功能特性

### 1. 文档列表
- 自动扫描 `docs` 文件夹下的所有 `.md` 文件
- 显示文档标题、分类、大小和修改时间
- 支持按分类筛选文档
- 支持刷新文档列表

### 2. 文档搜索
- 支持按关键词搜索文档
- 搜索标题和内容
- 显示匹配的上下文
- 高亮显示匹配结果

### 3. 文档阅读
- 在侧边抽屉中查看文档内容
- Markdown 渲染支持
- 代码高亮显示
- 支持表格、列表、引用等 Markdown 语法
- 响应式布局

### 4. 文档分类
- 自动根据文件夹结构分类
- 支持多级分类
- 显示每个分类的文档数量

## 使用方法

### 1. 访问文档阅读系统

在聊天界面头部点击"📖"图标，即可进入文档阅读系统。

### 2. 浏览文档

- 文档列表会自动加载所有 Markdown 文件
- 点击分类标签可以筛选文档
- 点击文档项可以查看文档内容

### 3. 搜索文档

- 在搜索框中输入关键词
- 按回车键或点击"搜索"按钮
- 查看搜索结果

### 4. 阅读文档

- 点击文档列表中的文档项
- 文档内容会在右侧抽屉中显示
- 支持滚动查看长文档
- 点击关闭按钮或点击遮罩层关闭文档

## 文档组织

### 文档存放位置

将 Markdown 文档放在插件的 `docs` 文件夹下：

```
D:\blender\Plugin\addons\ainode\docs\
├── blender/
│   ├── 00-总览.md
│   ├── 01-主面板文档.md
│   └── ...
├── web/
│   ├── 00-总览.md
│   ├── 01-主界面文档.md
│   └── ...
└── README.md
```

### 文档分类

文档会根据文件夹结构自动分类：

- `docs/blender/` → 分类：`blender`
- `docs/web/` → 分类：`web`
- `docs/README.md` → 分类：`未分类`

### 文档格式

文档使用 Markdown 格式，支持以下语法：

```markdown
# 一级标题
## 二级标题
### 三级标题

**粗体文本**
*斜体文本*

- 列表项1
- 列表项2

> 引用文本

\`\`\`python
代码块
\`\`\`

[链接文本](url)

![图片描述](image_url)
```

## API 接口

### 1. 获取文档列表

**接口**：`GET /api/docs/list`

**响应**：
```json
{
  "status": "Success",
  "message": "获取文档列表成功",
  "data": {
    "docs": [
      {
        "id": "blender/00-总览.md",
        "title": "总览",
        "category": "blender",
        "path": "blender/00-总览.md",
        "size": 1024,
        "modified": 1234567890,
        "modified_formatted": "2026-01-13 10:30:00"
      }
    ],
    "categories": ["blender", "web"]
  }
}
```

### 2. 获取文档内容

**接口**：`POST /api/docs/content`

**请求**：
```json
{
  "path": "blender/00-总览.md"
}
```

**响应**：
```json
{
  "status": "Success",
  "message": "获取文档内容成功",
  "data": {
    "path": "blender/00-总览.md",
    "content": "# 文档内容...",
    "size": 1024
  }
}
```

### 3. 获取文档分类

**接口**：`GET /api/docs/categories`

**响应**：
```json
{
  "status": "Success",
  "message": "获取文档分类成功",
  "data": {
    "categories": {
      "blender": {
        "name": "blender",
        "path": "blender",
        "doc_count": 5,
        "subcategories": []
      }
    }
  }
}
```

### 4. 搜索文档

**接口**：`POST /api/docs/search`

**请求**：
```json
{
  "keyword": "节点"
}
```

**响应**：
```json
{
  "status": "Success",
  "message": "搜索完成，找到 3 个结果",
  "data": {
    "results": [
      {
        "id": "blender/01-主面板文档.md",
        "title": "主面板文档",
        "path": "blender/01-主面板文档.md",
        "matches": [
          {
            "line": 10,
            "context": "节点分析功能..."
          }
        ]
      }
    ],
    "total": 3
  }
}
```

## 技术实现

### 后端（Blender + Flask）

- 使用 Flask 提供 RESTful API
- 遍历 `docs` 文件夹扫描文档
- 读取 Markdown 文件内容
- 实现搜索功能

### 前端（Vue 3）

- 使用 Naive UI 组件库
- Markdown 渲染使用 `markdown-it`
- 代码高亮使用 `highlight.js`
- 响应式布局设计

## 注意事项

1. **文档路径安全**：后端会验证文档路径，确保只能访问 `docs` 文件夹内的文件
2. **编码格式**：文档必须使用 UTF-8 编码
3. **文件类型**：仅支持 `.md` 文件
4. **性能优化**：大文档建议分段阅读
5. **缓存机制**：文档内容不会缓存，每次都是实时读取

## 扩展功能建议

### 1. 文档编辑
- 添加文档编辑功能
- 支持在线保存修改

### 2. 文档导出
- 导出为 PDF
- 导出为 HTML

### 3. 文档分享
- 生成分享链接
- 设置访问权限

### 4. 文档版本
- 支持文档版本管理
- 查看历史版本

### 5. 文档收藏
- 收藏常用文档
- 快速访问收藏列表

## 故障排除

### 问题1：文档列表为空

**原因**：`docs` 文件夹不存在或没有 `.md` 文件

**解决**：
- 检查 `docs` 文件夹是否存在
- 确保文件夹中有 `.md` 文件
- 点击"刷新"按钮重新加载

### 问题2：无法打开文档

**原因**：文档路径错误或文件损坏

**解决**：
- 检查文档是否在 `docs` 文件夹内
- 确认文档编码为 UTF-8
- 检查文件是否损坏

### 问题3：搜索无结果

**原因**：关键词不匹配或文档未索引

**解决**：
- 尝试使用不同的关键词
- 检查文档内容是否包含关键词
- 确认文档已正确加载

## 更新日志

### v1.0.0 (2026-01-13)
- 初始版本发布
- 支持文档列表查看
- 支持文档搜索
- 支持 Markdown 渲染
- 支持代码高亮
- 支持文档分类筛选
## 目标
- 采用纯 CDN 方式实现标准 AI 对话布局：左侧可折叠历史、中部消息流、底部输入框；不引入 npm 包或打包器。
- 保持现有后端接口与 Blender 联动：Web 流式展示，Blender 写入 `AINodeAnalysisResult`，两端结果一致。

## 组件库（CDN）选择
- 样式与布局：Bootstrap 5（CSS/JS CDN）
  - 链接：css、js、bootstrap-icons（侧栏、栅格、Offcanvas/Collapse、按钮、表单、图标）
- 可折叠/侧栏：Bootstrap Collapse + Offcanvas（左侧历史折叠/展开与移动端适配）
- 可调整宽度：Split.js（CDN）实现左/中分栏可拖拽调整宽度
- Markdown与代码高亮：
  - `marked`（CDN）做 Markdown 解析
  - `highlight.js`（CDN）做代码高亮主题（例如 atom-one-dark）
- 流式显示：原生 `fetch` + ReadableStream（已兼容）

## 页面结构（HTML 片段示意）
- 头部：标题与主题切换（保留）
- 主区：
  - 左栏（历史）：Collapse/Offcanvas 包裹 List；可搜索、清空、点击切换
  - 中部（对话）：消息流容器（支持 Markdown/代码高亮）、顶部对话标题/状态栏
  - 底部（输入框）：Textarea + 发送/终止按钮；Ctrl+Enter 发送
- 使用 Split.js 初始化左右面板的拖拽分割；移动端自动折叠为 Offcanvas

## 接口与数据流
- Web 发送：`POST /api/stream-analyze`（统一流式端点）
- 历史：`GET /api/get-messages`（列表项内容取最近用户消息或摘要）
- Blender 联动：维持后端统一结果存储/清空（`/api/get-analysis-result`、`/api/clear-analysis-result`），定时器写入文本块（现已完成）
- 参考后端位置：
  - 流式接口：`backend/server.py:109`
  - 统一结果读取：`backend/server.py:354`

## 前端实现步骤（纯 CDN）
1. 在页面 `<head>` 引入：
   - Bootstrap CSS/JS、Bootstrap Icons、Split.js、marked、highlight.js（含样式）
2. 重构 HTML 布局为三段式（左/中/底），保留当前 ID/事件绑定，以兼容现有 JS
3. 在 JS：
   - 初始化 Split.js 控制左右区尺寸
   - 解析/渲染消息：`marked` + `hljs.highlightAll()`；保留安全插入（默认文本，代码块使用高亮）
   - 发送时用 `fetch('/api/stream-analyze')`，逐段渲染消息流
   - 历史加载与点击填充保持现有逻辑（替换容器选择器）
4. 响应式与可访问性：
   - Offcanvas 在小屏做历史折叠；按钮加 `aria-label` 与 `aria-live`；Skeleton（用 Bootstrap 占位类）

## 适配两处前端
- 方案A：在当前 `frontend/src/index.html` 直接升级为 CDN 聊天界面
- 方案B：在 `web-chat`（Next.js）中也可通过 `<link>` 与 `<Script>` 引入上述 CDN，页面级使用原生 DOM 操作渲染（不依赖 npm 包），作为更完整的聊天站点；两者可并行存在（一致调用 Python 后端）。

## 验证
- 打开页面，左侧可折叠历史、拖拽调整面板宽度；中部流式消息按段出现并高亮代码；底部输入支持 Ctrl+Enter；状态栏文案更新
- Blender 文本块 `AINodeAnalysisResult` 与 Web 展示一致（统一后端结果）

## 交付
- 更新的 HTML（CDN 引入与新布局）、JS 初始化与事件绑定、简要 README（如何替换 CDN 与主题）

若确认使用 CDN（优先方案A：直接重构 `frontend`），我将据此实现并回归测试。